# Отчет по HW1: Регрессия для предсказания стоимости автомобилей

## 1. Что было сделано

Проведен разведочный анализ данных (EDA):

- Пропуски есть в столбцах mileage, engine, max_power,  torque, seats, как для обучающей выборки так и для тестовой.

- Дубликаты есть в каждом датасете:
  - 985 объектов которые встречаются в тренировчной выборке более 1 раза

- Выводы по дашборду:

  - Дубликатов порядка 7%
  - Пропусков порядка 3% по столбцам с пропусками
  - transmission имеет высокую корреляцию с целевой переменной равную 0.586
  - year имеет высокую корреляцию с целевой переменной равную 0.714
  - owner можно закодировать как порядковый
  - mileage, engine, max_power, torque можно преобразовать к численному очистив от единиц измерения
  - torque очень много форматов записи

- выводы по анализу статистик:

  - median и mean внутри каждого датасета отличаются довольно сильно для призаков selling_price km_driven, что говорит о ассиметрии в распределении значений признаков. Исходя только из этих значений вывод однозначно не сделаешь, может быть как большое количество объектов с большими занчениями призака, либо неочень большое количество но со сверхбольшими занчениями (выбросы). Из графиков дашборда видно, что проблема в выбросах. Если сравнивать занчения между датасетами, то они не сильно различаются, что говорит о похожести выборок.

Выполнена предобработка данных:

- Заполнены пропуски.

- Распарсина информаци из столбца torque на два torque и max_torque_rpm
- Преобразованы текстовые и категориальные признаки.

- Проведена нормализация числовых признаков.

Проведена визуализация данных и проанализировано распределение признаков.

- Из графиков распределения видно что есть положительная корреляция целевой переменной с year, max_power, torque, engine.
- Сильно коррелируют признаки (max_power, torque), (engine, torque). У (mileage, engine) отрицательная корреляция
- В трейне наблюадется чуть больше выбросов, в востальном взуально распределени похожи.
- признаки с наибольшей корреляцией:
  - (max_power, engine) корреляция равна 0.7

  - (max_power, torque) корреляция равна 0.7

  - (seats, engine) корреляция равна 0.7

- Были обучены модели только на вещественных признаках:

  - Linear Regression
  - Lasso с поиском гипрепараметров через GSCV
  - ElasticNet с поиском гипрепараметров через GSCV
  - Linear Regression c L0 регуляризации с поиском гипрепараметров через GSCV

- Были обучены модели только на вещественных и категориальных признаках:
  - Ridge с поиском гипрепараметров через GSCV

- Оценено качество модели на тренировочных и тестовых данных:
  - Для моделей на вещественных признаках качество было всреднем с небольшим разбросом следующим:

    - Train r2_score: 0.54
    - Test r2_score: 0.56
    - Train MSE: 131 799 545 290
    - Test MSE: 247 572 206 534
    - Train RMSE: 363 042
    - Test RMSE: 497 566

  - Для модели Ridge:

    - Train r2_score: 0.72
    - Test r2_score: 0.76
    - Train MSE: 78 979 481 289
    - Test MSE: 138 357 782 596
    - Train RMSE: 281 032
    - Test RMSE: 371 964
- Построен пайплайн для модели Ridge с alpha=1.

- Разработан веб-сервис для использования обученной модели.

## 2. Результаты

Метрики модели:

  - Train r2_score: 0.72
  - Test r2_score: 0.76
  - Train MSE: 78 979 481 289
  - Test MSE: 138 357 782 596
  - Train RMSE: 281 032
  - Test RMSE: 371 964

Работа API:
- Запрос в формате json
![Запрос в формате json](https://github.com/gmfrolov/course-ml-hse/blob/main/hw1/Query%20json.png)
- Ответ на запрос в формате json
![Ответ на запрос в формате json](https://github.com/gmfrolov/course-ml-hse/blob/main/hw1/Result%20json.png)
- Запрос в формате csv
![Запрос в формате csv](https://github.com/gmfrolov/course-ml-hse/blob/main/hw1/Query%20csv.png)
- Ответ на запрос в формате csv
![Ответ на запрос в формате csv](https://github.com/gmfrolov/course-ml-hse/blob/main/hw1/Result%20csv.png)

## 3. Что дало наибольший буст в качестве

- Обработка категориальных признаков с помощью OneHotEncoder.

- Использование Ridge-регрессии с подобранным параметром alpha=1.

## 4. Что сделать не вышло и почему

Реализовать функцию расчета корреляции Спирмена

Не удалось заняться Feature engineering

## 5. Дополнительно

Файл с весами модели сохранён в pipeline.pkl
